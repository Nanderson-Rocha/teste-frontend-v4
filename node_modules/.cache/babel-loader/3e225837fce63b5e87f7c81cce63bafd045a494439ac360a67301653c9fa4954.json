{"ast":null,"code":"import \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport equipmentStateHistory from \"../data/equipmentStateHistory.json\";\nimport equipmentState from \"../data/equipmentState.json\";\nimport equipmentData from \"../data/equipment.json\"; // Importar equipment.json\nimport EarningsDialog from \"../components/EarningsDialog.vue\";\nexport default {\n  name: \"CardProductivity\",\n  props: {\n    equipmentId: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    EarningsDialog: EarningsDialog\n  },\n  data: function data() {\n    return {\n      equipmentName: \"\",\n      // Adiciona o campo para o nome do equipamento\n      totalWorkTime: 0,\n      productiveHours: 0,\n      stoppedHours: 0,\n      // Novo campo para armazenar horas em estado \"Parado\"\n      maintenanceHours: 0,\n      // Novo campo para armazenar horas em estado \"Manutenção\"\n      productivityPercentage: 0\n    };\n  },\n  methods: {\n    calculateProductivity: function calculateProductivity() {\n      var _this = this;\n      // Filtra o histórico de estados para o equipmentId\n      var equipmentHistory = equipmentStateHistory.find(function (history) {\n        return history.equipmentId === _this.equipmentId;\n      });\n      if (!equipmentHistory) {\n        console.error(\"Equipamento não encontrado.\");\n        return;\n      }\n      var states = equipmentHistory.states;\n      if (states.length === 0) {\n        console.error(\"Nenhum estado encontrado para o equipamento.\");\n        return;\n      }\n\n      // Busca o nome do equipamento no equipment.json\n      var equipment = equipmentData.find(function (e) {\n        return e.id === _this.equipmentId;\n      });\n      if (equipment) {\n        this.equipmentName = equipment.name;\n      } else {\n        this.equipmentName = \"Nome não encontrado\";\n      }\n\n      // Ordena os estados por data\n      states.sort(function (a, b) {\n        return new Date(a.date) - new Date(b.date);\n      });\n      var totalWorkTimeMs = 0;\n      var productiveHoursMs = 0;\n      var stoppedHoursMs = 0; // Novo campo para calcular o tempo em estado \"Parado\"\n      var maintenanceHoursMs = 0; // Novo campo para calcular o tempo em estado \"Manutenção\"\n      var lastStateDate = new Date(states[0].date);\n      states.forEach(function (state, index) {\n        var currentState = equipmentState.find(function (eState) {\n          return eState.id === state.equipmentStateId;\n        });\n        if (currentState) {\n          var stateDate = new Date(state.date);\n\n          // Calcula o tempo total de trabalho\n          if (index === 0) {\n            totalWorkTimeMs = stateDate - new Date(states[0].date);\n          } else {\n            totalWorkTimeMs += stateDate - lastStateDate;\n          }\n\n          // Calcula o tempo de horas produtivas\n          if (currentState.name === \"Operando\" && index < states.length - 1) {\n            var nextStateDate = new Date(states[index + 1].date);\n            productiveHoursMs += nextStateDate - stateDate;\n          }\n\n          // Calcula o tempo de horas parado\n          if (currentState.name === \"Parado\" && index < states.length - 1) {\n            var _nextStateDate = new Date(states[index + 1].date);\n            stoppedHoursMs += _nextStateDate - stateDate;\n          }\n\n          // Calcula o tempo de horas em manutenção\n          if (currentState.name === \"Manutenção\" && index < states.length - 1) {\n            var _nextStateDate2 = new Date(states[index + 1].date);\n            maintenanceHoursMs += _nextStateDate2 - stateDate;\n          }\n          lastStateDate = stateDate;\n        }\n      });\n      this.totalWorkTime = totalWorkTimeMs / 3600000; // Convertendo de ms para horas\n      this.productiveHours = productiveHoursMs / 3600000; // Convertendo de ms para horas\n      this.stoppedHours = stoppedHoursMs / 3600000; // Convertendo de ms para horas\n      this.maintenanceHours = maintenanceHoursMs / 3600000; // Convertendo de ms para horas\n      this.productivityPercentage = this.productiveHours / this.totalWorkTime * 100;\n    },\n    openEarningsDialog: function openEarningsDialog() {\n      this.$refs.earningsDialog.openDialog();\n    }\n  },\n  watch: {\n    equipmentId: \"calculateProductivity\"\n  },\n  mounted: function mounted() {\n    this.calculateProductivity();\n  }\n};","map":{"version":3,"names":["equipmentStateHistory","equipmentState","equipmentData","EarningsDialog","name","props","equipmentId","type","String","required","components","data","equipmentName","totalWorkTime","productiveHours","stoppedHours","maintenanceHours","productivityPercentage","methods","calculateProductivity","_this","equipmentHistory","find","history","console","error","states","length","equipment","e","id","sort","a","b","Date","date","totalWorkTimeMs","productiveHoursMs","stoppedHoursMs","maintenanceHoursMs","lastStateDate","forEach","state","index","currentState","eState","equipmentStateId","stateDate","nextStateDate","openEarningsDialog","$refs","earningsDialog","openDialog","watch","mounted"],"sources":["/home/bruno/Documentos/Teste Aiko - Front END - FINAL/teste-frontend-v4/src/components/CardProductivity.vue"],"sourcesContent":["<template>\r\n  <v-card\r\n    class=\"mb-4\"\r\n    :variant=\"flat\"\r\n    color=\"teal-lighten-5\"\r\n    rounded=\"shaped\"\r\n    @click=\"openEarningsDialog\"\r\n  >\r\n    <v-card-title class=\"text-center\">\r\n      <span class=\"headline text-center\">{{ equipmentName }}</span>\r\n    </v-card-title>\r\n\r\n    <v-card-text>\r\n      <p><strong>Tempo Total de Trabalho:</strong> {{ totalWorkTime }} horas</p>\r\n      <p><strong>Horas Produtivas:</strong> {{ productiveHours }} horas</p>\r\n      <p><strong>Horas Parado:</strong> {{ stoppedHours }} horas</p>\r\n      <p><strong>Horas em Manutenção:</strong> {{ maintenanceHours }} horas</p>\r\n\r\n      <v-row justify=\"space-between\" class=\"align-center\">\r\n        <v-col>\r\n          <p><strong>Produtividade:</strong></p>\r\n        </v-col>\r\n        <v-col class=\"text-right\">\r\n          <h2 class=\"text-cyan-darken-4\">{{ productivityPercentage.toFixed(2) }}%</h2>\r\n        </v-col>\r\n      </v-row>\r\n    </v-card-text>\r\n\r\n    <!-- Adiciona o componente EarningsDialog -->\r\n    <EarningsDialog\r\n      ref=\"earningsDialog\"\r\n      :equipmentId=\"equipmentId\"\r\n      :equipmentName=\"equipmentName\"\r\n      :productiveHours=\"productiveHours\"\r\n      :stoppedHours=\"stoppedHours\"\r\n      :maintenanceHours=\"maintenanceHours\"\r\n    />\r\n  </v-card>\r\n</template>\r\n\r\n\r\n<script>\r\nimport equipmentStateHistory from \"../data/equipmentStateHistory.json\";\r\nimport equipmentState from \"../data/equipmentState.json\";\r\nimport equipmentData from \"../data/equipment.json\"; // Importar equipment.json\r\nimport EarningsDialog from \"../components/EarningsDialog.vue\"\r\n\r\nexport default {\r\n  name: \"CardProductivity\",\r\n  props: {\r\n    equipmentId: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n  },\r\n  components: {\r\n    EarningsDialog\r\n  },\r\n  data() {\r\n    return {\r\n      equipmentName: \"\", // Adiciona o campo para o nome do equipamento\r\n      totalWorkTime: 0,\r\n      productiveHours: 0,\r\n      stoppedHours: 0, // Novo campo para armazenar horas em estado \"Parado\"\r\n      maintenanceHours: 0, // Novo campo para armazenar horas em estado \"Manutenção\"\r\n      productivityPercentage: 0,\r\n    };\r\n  },\r\n  methods: {\r\n    calculateProductivity() {\r\n      // Filtra o histórico de estados para o equipmentId\r\n      const equipmentHistory = equipmentStateHistory.find(\r\n        (history) => history.equipmentId === this.equipmentId\r\n      );\r\n\r\n      if (!equipmentHistory) {\r\n        console.error(\"Equipamento não encontrado.\");\r\n        return;\r\n      }\r\n\r\n      const states = equipmentHistory.states;\r\n      if (states.length === 0) {\r\n        console.error(\"Nenhum estado encontrado para o equipamento.\");\r\n        return;\r\n      }\r\n\r\n      // Busca o nome do equipamento no equipment.json\r\n      const equipment = equipmentData.find((e) => e.id === this.equipmentId);\r\n      if (equipment) {\r\n        this.equipmentName = equipment.name;\r\n      } else {\r\n        this.equipmentName = \"Nome não encontrado\";\r\n      }\r\n\r\n      // Ordena os estados por data\r\n      states.sort((a, b) => new Date(a.date) - new Date(b.date));\r\n\r\n      let totalWorkTimeMs = 0;\r\n      let productiveHoursMs = 0;\r\n      let stoppedHoursMs = 0; // Novo campo para calcular o tempo em estado \"Parado\"\r\n      let maintenanceHoursMs = 0; // Novo campo para calcular o tempo em estado \"Manutenção\"\r\n      let lastStateDate = new Date(states[0].date);\r\n\r\n      states.forEach((state, index) => {\r\n        const currentState = equipmentState.find(\r\n          (eState) => eState.id === state.equipmentStateId\r\n        );\r\n\r\n        if (currentState) {\r\n          const stateDate = new Date(state.date);\r\n\r\n          // Calcula o tempo total de trabalho\r\n          if (index === 0) {\r\n            totalWorkTimeMs = stateDate - new Date(states[0].date);\r\n          } else {\r\n            totalWorkTimeMs += stateDate - lastStateDate;\r\n          }\r\n\r\n          // Calcula o tempo de horas produtivas\r\n          if (currentState.name === \"Operando\" && index < states.length - 1) {\r\n            const nextStateDate = new Date(states[index + 1].date);\r\n            productiveHoursMs += nextStateDate - stateDate;\r\n          }\r\n\r\n          // Calcula o tempo de horas parado\r\n          if (currentState.name === \"Parado\" && index < states.length - 1) {\r\n            const nextStateDate = new Date(states[index + 1].date);\r\n            stoppedHoursMs += nextStateDate - stateDate;\r\n          }\r\n\r\n          // Calcula o tempo de horas em manutenção\r\n          if (currentState.name === \"Manutenção\" && index < states.length - 1) {\r\n            const nextStateDate = new Date(states[index + 1].date);\r\n            maintenanceHoursMs += nextStateDate - stateDate;\r\n          }\r\n\r\n          lastStateDate = stateDate;\r\n        }\r\n      });\r\n\r\n      this.totalWorkTime = totalWorkTimeMs / 3600000; // Convertendo de ms para horas\r\n      this.productiveHours = productiveHoursMs / 3600000; // Convertendo de ms para horas\r\n      this.stoppedHours = stoppedHoursMs / 3600000; // Convertendo de ms para horas\r\n      this.maintenanceHours = maintenanceHoursMs / 3600000; // Convertendo de ms para horas\r\n      this.productivityPercentage = (this.productiveHours / this.totalWorkTime) * 100;\r\n    },\r\n    \r\n     openEarningsDialog() {\r\n      this.$refs.earningsDialog.openDialog();\r\n    },\r\n  },\r\n  watch: {\r\n    equipmentId: \"calculateProductivity\",\r\n  },\r\n  mounted() {\r\n    this.calculateProductivity();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.headline {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: rgb(46, 172, 172);\r\n  text-align: center;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}